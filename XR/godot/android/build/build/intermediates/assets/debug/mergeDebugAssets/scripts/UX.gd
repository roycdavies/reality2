# ------------------------------------------------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------------------------------------------------

extends Node

# ------------------------------------------------------------------------------------------------------------------------------------------------------
# Public variables
# ------------------------------------------------------------------------------------------------------------------------------------------------------
@export var menus: Node
@export var input_box: Node
# ------------------------------------------------------------------------------------------------------------------------------------------------------



# ------------------------------------------------------------------------------------------------------------------------------------------------------
# Signals
# ------------------------------------------------------------------------------------------------------------------------------------------------------
signal add_new_node(name: String)
# ------------------------------------------------------------------------------------------------------------------------------------------------------



# ------------------------------------------------------------------------------------------------------------------------------------------------------
# Private variables
# ------------------------------------------------------------------------------------------------------------------------------------------------------
var mode = "selecting"
# ------------------------------------------------------------------------------------------------------------------------------------------------------


# ------------------------------------------------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------------------------------------------------
func _ready():
	pass
# ------------------------------------------------------------------------------------------------------------------------------------------------------



# ------------------------------------------------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------------------------------------------------
func unselect():
	if (input_box):
		if mode == "NewNodeEnteringText_1":
			mode = "NewModeEnteringText"
		elif mode == "NewModeEnteringText":
			print("Cancelling")
			set_menu("Reality2")
			mode = "selecting"
# ------------------------------------------------------------------------------------------------------------------------------------------------------


		
# ------------------------------------------------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------------------------------------------------
func set_menu(the_name: String):
	if menus:
		menus.show_child_by_name(the_name)
	if input_box:
		input_box.visible = false
		input_box.set_process(false)
	mode = "selecting"
# ------------------------------------------------------------------------------------------------------------------------------------------------------



# ------------------------------------------------------------------------------------------------------------------------------------------------------
# What to do when a menu is selected
# ------------------------------------------------------------------------------------------------------------------------------------------------------
func menu_selected(slot, id):
	if (mode == "selecting"):
		match (slot.get_parent().name):
			"Reality2":
				match (slot.name):
					"CloseAll":
						print("Closing all connections")
					"ReloadAll":
						print("Reloading all nodes")
					"OpenNew":
						print("Opening a new node")
						mode = "NewNodeEnteringText_1"
						menus.show_child(-1)
						input_box.visible = true
						input_box.set_process(true)
			"Node":
				match (slot.name):
					"Close":
						print("Closing this node")
					"Reload":
						print("Reloading this node")
					"NewSentant":
						print("Creating a new sentant")
					"Info":
						print("Getting node info")
			"Sentant":
				match (slot.name):
					"Delete":
						print("Deleting this sentant")
					"Message":
						print("Sending an event to this sentant")
					"Info":
						print("Getting sentant info")
# ------------------------------------------------------------------------------------------------------------------------------------------------------



# ------------------------------------------------------------------------------------------------------------------------------------------------------
# What to do when
# ------------------------------------------------------------------------------------------------------------------------------------------------------
func enterkey_pressed(new_text: String):
	print("Opening: " + new_text)
	emit_signal("add_new_node", new_text)
	set_menu("Reality2")
	mode = "selecting"
# ------------------------------------------------------------------------------------------------------------------------------------------------------



# ------------------------------------------------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------------------------------------------------
func esckey_pressed():
	if (input_box and mode == "NewNodeEnteringText"):
		print("Esc Key")
		set_menu("Reality2")
		mode = "selecting"
# ------------------------------------------------------------------------------------------------------------------------------------------------------



# ------------------------------------------------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------------------------------------------------
func choosing_yes_or_no():
	pass
# ------------------------------------------------------------------------------------------------------------------------------------------------------
